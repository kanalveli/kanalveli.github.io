!function(){var o,r,n=new Array(4),e=[],f=!0,t=$(".cell_out"),a={2:"white",4:"#eee4da",8:"#f2b179",16:"#f59563",32:"#f57c5f",64:"#f65d3b",128:"#EDCE71",256:"#EDCC61",512:"#ECC850",1024:"#EDC53F",2048:"#ECC42C"};$(document).ready(function(){for(var o=0;4>o;o++)n[o]=new Array(4);k(),$("#reset").click(k)});var c=function(o){switch($(document).unbind("keydown",c),r=!1,o.which){case 37:v(),d(0,0,4,3,1,1,0,1);break;case 38:l(),d(0,0,3,4,1,1,1,0);break;case 39:s(),d(0,3,4,0,1,-1,0,-1);break;case 40:u(),d(3,0,0,4,-1,1,-1,0)}o.preventDefault(),h(),e.length?$(document).bind("keydown",c):alert("You Lost")},d=function(o,e,f,t,a,c,i,d){var u,l;for(u=o;u-f!=0;u+=a)for(l=e;l-t!=0;l+=c)n[u][l]==n[u+i][l+d]&&0!=n[u][l]&&(n[u][l]+=n[u+i][l+d],n[u+i][l+d]=0,r=!0);for(u=o;u-f!=0;u+=a)for(l=e;l-t!=0;l+=c)0==n[u][l]&&(n[u][l]+=n[u+i][l+d],n[u+i][l+d]=0);b(),r&&m()},u=function(){var o,e,f;for(r=!1,e=0;4>e;e++)for(o=3;o>0;o--)if(0==n[o][e]){for(f=o-1;f>=0&&0==n[f][e];)f--;f>=0&&(n[o][e]=n[f][e],n[f][e]=0,r=!0)}},l=function(){var o,e,f;for(r=!1,e=0;4>e;e++)for(o=0;4>o;o++)if(0==n[o][e]){for(f=o+1;3>=f&&0==n[f][e];)f++;3>=f&&(n[o][e]=n[f][e],n[f][e]=0,r=!0)}},s=function(){var o,e,f;for(r=!1,e=0;4>e;e++)for(o=3;o>0;o--)if(0==n[e][o]){for(f=o-1;f>=0&&0==n[e][f];)f--;f>=0&&(n[e][o]=n[e][f],n[e][f]=0,r=!0)}},v=function(){var o,e,f;for(r=!1,e=0;4>e;e++)for(o=0;4>o;o++)if(0==n[e][o]){for(f=o+1;3>=f&&0==n[e][f];)f++;3>=f&&(n[e][o]=n[e][f],n[e][f]=0,r=!0)}},h=function(){for(e=[],i=0;i<4;i++)for(j=0;j<4;j++)0==n[i][j]&&e.push(4*i+j)},m=function(){h(),o=Math.floor(Math.random()*e.length),i=Math.floor(e[o]/4),j=e[o]%4,n[i][j]=0==Math.floor(3*Math.random())?4:2;var r=document.createElement("div");$(r).addClass("tile"),$(r).css("background-color",a[n[i][j]+""]).text(n[i][j]).hide(),$(t[4*i+j]).empty().append(r),$(r).fadeIn(),h()},b=function(){var o,r;for(o=0;4>o;o++)for(r=0;4>r;r++)if($(t[4*o+r]).empty(),0!=n[o][r]){var e=document.createElement("div");$(e).addClass("tile"),$(e).css("background-color",a[n[o][r]+""]).text(n[o][r]),"2048"==n[o][r]&&f&&(alert("you won"),f=!1),$(t[4*o+r]).append(e)}},k=function(){var o,r;for(o=0;4>o;o++)for(r=0;4>r;r++)n[o][r]=0,$(t[4*o+r]).css("background-color","#d3d3d3");m(),m(),$(document).unbind("keydown",c),$(document).bind("keydown",c)}}();