!function(t){var e=!0;t.fn.fetchUserImg=function(e){if(!this.length)return this;var n={username:"kanalveli",tagname:"hogwarts",clientID:null,limit:1,id:null,loadMore:null,usrid:null,byTag:!1,error:function(){},success:function(){}};settings={},settings=t.extend({},n,e),elem=t(this),elem.each(function(){settings.clientID?t.ajax({type:"GET",url:"https://api.instagram.com/v1/users/search?q="+settings.username+"&client_id="+settings.clientID+"&callback=?",dataType:"jsonp",success:function(e){settings.usrid=e.data[0].id,settings.loadMore?(elem.after('<input id="loadmore" type="button" value="Load More">'),t("#loadmore").css("float","right").click(function(){loadContent()})):0==settings.loadMore?elem.after('<p id="loadingBar" style="text-align:center">loading....</p>'):settings.limit=1,loadContent()},error:function(t,e,n){console.log(e,n)}}):console.log("client ID missing")})},changeBackground=function(e,n,a){var i=new Image;i.crossOrigin="",i.src=e.images.thumbnail.url;var o=document.createElement("canvas"),s=o.getContext("2d");i.onload=function(){s.drawImage(i,0,0),idata=s.getImageData(0,0,150,150).data;var e,o,l,r,c,d,g={};for(r=0;r<idata.length;r+=4)e=idata[r],o=idata[r+1],l=idata[r+2],c=findSimilarColor(g,e,o,l),null==c&&(d=new RGBColour(e,o,l),c=d.getCSSIntegerRGB()),c in g?g[c]++:g[c]=1;colSorted=Object.keys(g).sort(function(t,e){return g[e]-g[t]});for(var u=0;3>u;u++)rgb=colSorted[u].slice(4,-1).split(","),hsv=new RGBColour(parseInt(rgb[0]),parseInt(rgb[1]),parseInt(rgb[2])).getHSV(),hsv.v<50&&(t(a).css("color","#ffffff"),t(n).css("border-color","#ffffff"));null==settings.loadMore&&t(elem.children()).remove(),t(a).appendTo(n),t(n).css("background",colSorted[0]).css("background-image","radial-gradient(circle at bottom,"+colSorted[5]+","+colSorted[4]+","+colSorted[3]+","+colSorted[2]+","+colSorted[1]+","+colSorted[0]+")").hide().appendTo(elem),t(n).fadeIn(1500)}},findSimilarColor=function(t,e,a,i){var i;for(colr in t)if(rgb=colr.slice(4,-1).split(","),l=Math.abs(e-parseInt(rgb[0])),m=Math.abs(a-parseInt(rgb[1])),n=Math.abs(i-parseInt(rgb[2])),l<10&&m<10&&n<10)return colr;return null},autoload=function(){t(window).scrollTop()+t(window).height()==t(document).height()&&(t(window).unbind("scroll"),t("#loadingBar").show(),loadContent())},loadContent=function(){var n;settings.byTag?(n="https://api.instagram.com/v1/tags/"+settings.tagname+"/media/recent/?client_id="+settings.clientID+"&count="+settings.limit+"&callback=?",null!=settings.id&&(n+="&max_tag_id="+settings.id)):(n="https://api.instagram.com/v1/users/"+settings.usrid+"/media/recent/?client_id="+settings.clientID+"&count="+settings.limit+"&callback=?",null!=settings.id&&(n+="&max_id="+settings.id)),t.ajax({type:"GET",url:n,dataType:"jsonp",success:function(n){if(n.data.length){e=!0;for(var a=0;a<n.data.length;a++){var i,o,s=n.data[a];"image"===s.type&&(i=document.createElement("div"),t(i).html('<a target="_blank" href="'+s.link+'"><img class="instaphotos" src="'+s.images.standard_resolution.url+'" alt="Instagram Image" data-filter="'+s.filter+'" /></a>').addClass("bgdiv"),o=document.createElement("p"),t(o).html(null==s.caption?"":s.caption.text).addClass("caption"),changeBackground(s,i,o))}settings.id=n.data[n.data.length-1].id,settings.byTag&&(settings.id=n.pagination.next_max_id),0==settings.loadMore&&(t(window).bind("scroll",autoload),t("#loadingBar").hide())}},error:function(t,e,n){console.log(e,n)},complete:function(){null==settings.loadMore&&e&&(e=!1,setTimeout(loadContent,3e3))}})}}(jQuery);